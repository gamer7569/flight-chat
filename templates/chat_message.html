<div class="chat-message {{self}}" id="{{_id}}">
  <img src="{{imageUrl}}" class="chat-message-author" />
  <div class="chat-message-text">{{text}}</div>
  {{#notSent}}
    <div class="chat-message-not-sent">
      <form class="chat-re-emit-input" data-event="uiReEmitMessage">
        <input type="hidden" name="_id" value="{{_id}}">
        <input type="hidden" name="conversationId" value="{{conversationId}}">
        <button type="submit"><img src="img/spinner-white.png" class="animRotateRound"></button>
      </form>
      
      <script type="text/javascript">
        (function() {
          // TODO: move this into a component
          setTimeout(function(){
            var $form = $('#'+{{_id}}).find('.chat-re-emit-input');
            if ($form.length > 0) {
              $form.find('button').addClass('red').html(
                '<span class="retry">retry</span>' +
                '<span class="arrow-right"></span>'
              );
            }
          }, 10000);
        })();
      </script>
    </div>
  {{/notSent}}
</div>